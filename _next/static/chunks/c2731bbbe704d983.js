(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,68476,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(22016),a=e.i(18566),l=e.i(5257);let o=class{static async register(e){return l.default.post("user/auth/register/",e)}static async verifyOtp(e){return l.default.post("user/auth/verify-otp/",e)}static async resendOtp(e){return l.default.post("user/auth/resend-otp/",{email:e})}static async login(e){let s=await l.default.post("user/auth/login/",e);return s.access&&(localStorage.setItem("authToken",s.access),s.refresh&&localStorage.setItem("refreshToken",s.refresh)),s}static logout(){localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken")}static async verifyToken(e){return l.default.post("user/auth/token/verify/",{token:e})}static async refreshToken(e){let s=await l.default.post("user/auth/token/refresh/",{refresh:e});return s.access&&localStorage.setItem("authToken",s.access),s}static async getCurrentUser(){return l.default.get("user/auth/me/",!0)}static async authenticateWithGoogle(e){let s=await l.default.post("user/auth/google/token/",e);return s.access&&(localStorage.setItem("authToken",s.access),s.refresh&&localStorage.setItem("refreshToken",s.refresh)),s}static isAuthenticated(){return null!==localStorage.getItem("authToken")}static async requestPasswordReset(e){return l.default.post("user/auth/password-reset-request/",{email:e})}static async confirmPasswordReset(e){return l.default.post("user/auth/password-reset-confirm/",e)}};function n(){let[e,l]=(0,t.useState)("request"),[n,i]=(0,t.useState)({email:""}),[d,c]=(0,t.useState)({email:"",otp:"",newPassword:"",confirmPassword:""}),[u,m]=(0,t.useState)(null),[h,x]=(0,t.useState)(null),[p,f]=(0,t.useState)(!1),[w,g]=(0,t.useState)(!1),b=(0,a.useRouter)(),y=e=>{let{name:s,value:t}=e.target;c({...d,[s]:t})},v=async()=>{f(!0),m(null),x(null);try{let e=await o.requestPasswordReset(n.email);x(e.message||"Password reset code sent to your email!"),c({...d,email:n.email}),l("reset")}catch(e){m(e.message||"Failed to send password reset email. Please try again.")}finally{f(!1)}},j=async()=>{f(!0),m(null);try{let e=await o.confirmPasswordReset({email:d.email,otp_code:d.otp,new_password:d.newPassword,new_password2:d.confirmPassword});x(e.message||"Password reset successful! You can now log in with your new password."),setTimeout(()=>{b.push("/Authentication/login")},3e3)}catch(e){m(e.message||"Failed to reset password. Please try again.")}finally{f(!1)}},N=async()=>{g(!0),m(null),x(null);try{let e=await o.requestPasswordReset(d.email);x(e.message||"New password reset code sent to your email!"),c({...d,otp:""})}catch(e){m(e.message||"Failed to resend password reset code. Please try again.")}finally{g(!1)}},P=async s=>{if(s.preventDefault(),m(null),x(null),"request"===e){if(!n.email)return void m("Please enter your email address");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email))return void m("Please enter a valid email address");await v()}else if("reset"===e){if(6!==d.otp.length)return void m("Please enter a valid 6-digit verification code");if(!d.newPassword||!d.confirmPassword)return void m("Please fill in all password fields");if(d.newPassword!==d.confirmPassword)return void m("Passwords do not match");if(d.newPassword.length<8)return void m("Password must be at least 8 characters long");let e=/[a-zA-Z]/.test(d.newPassword),s=/\d/.test(d.newPassword),t=/[!@#$%^&*(),.?":{}|<>]/.test(d.newPassword);if(!(e&&(s||t)))return void m("Password must include letters and at least numbers or special characters");await j()}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"request"===e?"Reset your password":"Enter reset code"}),(0,s.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"request"===e?(0,s.jsxs)(s.Fragment,{children:["Remember your password?"," ",(0,s.jsx)(r.default,{href:"/Authentication/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in here"})]}):`We've sent a 6-digit reset code to ${d.email}`})]}),u&&(0,s.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsx)("p",{className:"text-sm text-red-700",children:u})})]})}),h&&(0,s.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsx)("p",{className:"text-sm text-green-700",children:h})})]})}),"request"===e?(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:P,children:[(0,s.jsx)("div",{className:"rounded-md shadow-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your email address",value:n.email,onChange:e=>{i({email:e.target.value})}}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"We'll send you a 6-digit code to reset your password"})]})}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:p,className:`group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white ${p?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),"Sending reset code..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,s.jsxs)("svg",{className:"h-5 w-5 text-blue-500 group-hover:text-blue-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:[(0,s.jsx)("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),(0,s.jsx)("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),"Send Reset Code"]})})})]}):(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:P,children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reset Code"}),(0,s.jsx)("input",{id:"otp",name:"otp",type:"text",autoComplete:"one-time-code",required:!0,maxLength:6,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm text-center text-2xl tracking-widest",placeholder:"000000",value:d.otp,onChange:e=>{let{value:s}=e.target,t=s.replace(/\D/g,"").slice(0,6);c({...d,otp:t})}}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Enter the 6-digit code sent to your email"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,s.jsx)("input",{id:"newPassword",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"New password (min. 8 characters)",value:d.newPassword,onChange:y})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,s.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Confirm new password",value:d.confirmPassword,onChange:y})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{type:"submit",disabled:p||6!==d.otp.length,className:`group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white ${p||6!==d.otp.length?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),"Resetting password..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-blue-500 group-hover:text-blue-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),"Reset Password"]})}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("button",{type:"button",onClick:N,disabled:w,className:"text-sm text-blue-600 hover:text-blue-500 font-medium disabled:text-gray-400",children:w?"Sending...":"Resend Code"}),(0,s.jsx)("button",{type:"button",onClick:()=>{l("request"),m(null),x(null),c({email:"",otp:"",newPassword:"",confirmPassword:""})},className:"text-sm text-gray-600 hover:text-gray-500 font-medium",children:"Change Email"})]})]}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Didn't receive the code? Check your spam folder or"," ",(0,s.jsx)("button",{type:"button",onClick:N,disabled:w,className:"text-blue-600 hover:text-blue-500 font-medium",children:"try again"})]})})]})]})})}e.s(["default",()=>n],68476)}]);